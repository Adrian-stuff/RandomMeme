<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random Meme</title>
  </head>
  <body>
    <div class="caption"></div>
    <div class="container"></div>
    <h1 id="text">Loading please wait :)</h1>
    <div class="bottom">
      <h3>This page generate random meme per reload.</h3>
    </div>

    <style>
      @font-face {
        font-family: Comic-Sans;
        src: url(COMIC.TTF);
      }
      html {
        font-family: "Comic-Sans";
      }
      .caption {
        text-align: center;
        position: relative;
      }
      .bottom {
        text-align: center;
        position: relative;
      }
      .container {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 15px auto 15px auto;
      }

      .meme {
        height: auto;
        width: 100%;
        max-width: 500px;
        padding-left: 0;
        padding-right: 0;
      }
      @media only screen and (min-device-width: 414px) and (max-device-width: 736px) {
        .meme {
          max-width: 350px;
        }
      }
      #authorLink {
        text-decoration: none;
        color: #037387;
      }
      #text {
        text-align: center;
      }
    </style>
    <script>
      var bottom = document.querySelector(".bottom");
      var button = document.createElement("button");

      var body = document.querySelector(" .container");
      var img = document.createElement("img");
      var caption = document.querySelector(".caption");

      var author = document.createElement("h2");
      var authorLink = document.createElement("a");

      var captionText = document.createElement("h2");
      var loading = document.getElementById("text");

      async function getData() {
        await fetch("https://meme-api.herokuapp.com/gimme")
          .then((res) => res.json())
          .then((data) => {
            try {
              img.src = data.url;
              img.className = "meme";
              img.setAttribute(
                "onclick",
                `window.location='${data.postLink}';`
              );
              loading.innerHTML = "";
              author.textContent = `author: u/${data.author}`;
              captionText.textContent = `${data.title}`;
              authorLink.setAttribute(
                "href",
                `https://reddit.com/user/${data.author}`
              );
              authorLink.id = "authorLink";
              button.setAttribute("onclick", "window.location.reload();");
              button.textContent = "Reload";

              authorLink.append(author);
              caption.appendChild(authorLink);
              caption.appendChild(captionText);
              body.appendChild(img);
              bottom.append(button);
            } catch (error) {
              if (error) {
                console.log(error);
                return;
              }
            }

            console.log(data);
          });
      }
      getData();
    </script>
  </body>
</html>
